<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Mapa Elecciones</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
    integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
    crossorigin=""/>



    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
    integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
    crossorigin=""></script>

<!-- 1 -->
      <link title="timeline-styles" rel="stylesheet" href="https://cdn.knightlab.com/libs/timeline3/latest/css/timeline.css">

<!-- 2 -->
    <script src="https://cdn.knightlab.com/libs/timeline3/latest/js/timeline.js"></script>

    <script src="https://d3js.org/d3.v4.min.js"></script>

    <script src="datos.js" type="text/javascript"></script>
  </head>

 

<body>

  <div class="container header">

    <h1>Seguimiento Electoral</h1>
     <h3> Elecciones México 2018</h3>

   
  </div>

  

<div class="container timeline">

  

    <div id='timeline-embed' style="width: 100%; height: 800px" ></div>

    <!-- <div id='timeline-anaya' style="width: 100%; height: 800px"></div> -->

</div>

<div class="container">

  <h2>Conoce las Propuestas</h2>
    <p>Selecciona tus opciones</p>

    <div id="checkboxes"> 
      <label for="chc1"> 
          <input name="Candidato" class="candidato" id="chc1" type="checkbox" value="Meade" />
          Meade
      </label>
      <label for="chc2"> 
          <input name="Candidato"  class="candidato" id="chc2" type="checkbox" value="AMLO" />
          AMLO
      </label>
      <label for="chc3"> 
          <input name="Candidato" class="candidato" id="chc3" type="checkbox" value="Anaya" />
          Anaya
      </label>
     
      <label for="chc9"> 
        <input name="tema" class="tema" id="chc9" type="checkbox" value="Administración Pública"/>
        Administración Pública
    </label>

    <label for="chc5"> 
      <input name="tema" class="tema" id="chc5" type="checkbox" value="Corrupción" />
      Corrupción
  </label>

    <label for="chc9"> 
      <input name="tema" class="tema" id="chc9" type="checkbox" value="Desarrollo Económico"/>
      Desarrollo Económico
  </label>

  <label for="chc7"> 
    <input name="tema" class="tema" id="chc7" type="checkbox" value="Desarrollo Social"/>
    Desarrollo Social
</label>
      <label for="chc6"> 
          <input name="tema" class="tema" id="chc6" type="checkbox" value="Educación"/>
          Educación
      </label>
      
      <label for="chc8">
        <input name="tema" class="tema" id="chc8" type="checkbox" value="Género"/>
        Género
    </label>

    <label for="chc8">
      <input name="tema" class="tema" id="chc8" type="checkbox" value="Medio Ambiente"/>
      Medio Ambiente
  </label>

  <label for="chc8">
    <input name="tema" class="tema" id="chc8" type="checkbox" value="Política Exterior"/>
    Política Exterior
</label>

<label for="chc8">
  <input name="tema" class="tema" id="chc8" type="checkbox" value="Salud"/>
  Salud
</label>

      <label for="chc6"> 
          <input name="tema" class="tema" id="chc6" type="checkbox" value="Seguridad"/>
          Seguridad
      </label>
     
     
      
      

      <button id="reset">Reset</button>
     
    </div>
    
    <div id="proposals"></div>
    
    
    
      
</div>

<div class= "container">

  <h2>Giras de los Candidatos</h2>  

  <div class="row mapa">
        <div class= "col-lg-9 col-md-10 col-sm-12">
        <div id="mapid"></div>
  </div>

 
  
  <div class= "col-lg-3 col-md-2 col-sm-12 text-center">
    <p> Sigue la ruta de cada candidato </p>
  </div>
  
  </div> 

</div>


<!--JS MAPA -->
<script>
var mymap = L.map('mapid', { 
    maxZoom: 5.5,
        minZoom: 2.5,
        zoomSnap: 0,
        zoomDelta: 0.25,
        maxBoundsViscosity: 0.9,
}).setView([24.132442, -102.852647], 7);
L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/light-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoibmVsbGFsZWxhIiwiYSI6ImNqY25wdGkydjFtYmozM3J3bmFtM3J4OTIifQ.8bjGPz0lsuXKQO41g3dhsA', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox.streets',
     
      }).addTo(mymap);
</script>



<!-- JS TIMELINE -->
<script type="text/javascript">
var options = {
    initial_zoom: 5,
    timenav_position: "top",
    marker_padding: 0,
    language: "es",
    start_at_end: false
  
  }
  timeline = new TL.Timeline('timeline-embed',
    'https://docs.google.com/spreadsheets/d/1TwLRmc5eA_1uolSS7Zo71BxP2WTCJZoJBLgjo4iH8KI/edit#gid=0', options);
</script>

<!-- JS FILTRO INFERNAL -->
<script>


  var totalPropuestas = datos.filter(function(el){
    return el.Group == "Propuestas";
  
    
   
  });
  
  console.log(totalPropuestas);
  
    var html = "<table id='theTable'>";
      "<tbody>"
    for (var i= 0; i< totalPropuestas.length; i++){
      html += "<tr class='props'>";
        html+="<td class='candidato'>"+totalPropuestas[i].Candidato+"</td>";
        html+="<td class='tema'>"+totalPropuestas[i].Tema+"</td>"
       html+="<td class='headline'>"+totalPropuestas[i].Headline+"</td>";
       html+="<td  class='text'>"+totalPropuestas[i].Text+"</td>";
       html+="<td  class='fuente'>"+ "<a href='" + totalPropuestas[i].Fuente + "'> Leer nota </a>" +"</td>";
      
         
  
          html+="</tr>";
    
    }
    "</tbody>"
    html+="</table>";
  document.getElementById("proposals").innerHTML = html;

  $("#reset").click(function(){
        $("tbody tr").show();
        $( "input:checkbox:checked" ).prop( "checked", false );
    });

    $(".candidato,.tema").on("change", function () {
        var cand = $(".candidato:checked").map(function () {
            return $(this).val()
        }).get();
        var tem = $(".tema:checked").map(function () {
            return $(this).val()
        }).get();
        
        var all = $("tbody tr").hide();
        var temas = $(".tema").filter(function () {
            var tema = $(this).text(),
            	index2 = $.inArray(tema, tem);
            	return index2 >=0
        }).parent()
        if (!temas.length) temas = all
        var candidatos = $(".candidato").filter(function () {
            var candidato = $(this).text(),
                index = $.inArray(candidato, cand);
                
            return index >= 0
        }).parent()
        if (!candidatos.length) candidatos = all
        
        temas.filter(candidatos).show()
        
        console.log(temas,candidatos)

    });
  
  // $("input:checkbox").on("change", function () {
  //       var a = $("input:checkbox:checked").map(function () {
  //           return $(this).val()
  //       }).get()
  //       $("#theTable tr").hide();
  //       var candidatos = $(".candidato").filter(function () {
  //           var candidato = $(this).text(),
  //               index = $.inArray(candidato, a);
  //           return index >= 0
  //       }).parent().show();
  //   }).first().change();
   
 
  
  </script>
  
    

</body>


</html>